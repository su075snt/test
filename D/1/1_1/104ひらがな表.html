<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ひらがな学習 - Hiragana Learning</title>
    <style>
        :root {
            --primary-color: #ff7675; /* Màu chủ đạo Hiragana hơi hồng cam */
            --bg-color: #fcfcfc;
            --char-color-1: #6c5ce7; /* Màu xanh tím */
            --char-color-2: #e84393; /* Màu hồng đậm */
        }
        body { font-family: 'Hiragino Kaku Gothic Pro', 'Meiryo', sans-serif; background-color: var(--bg-color); margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab-btn { padding: 12px 25px; cursor: pointer; border: 2px solid #ddd; background: white; border-radius: 12px; font-weight: bold; transition: 0.3s; }
        .tab-btn.active { background: var(--primary-color); color: white; border-color: var(--primary-color); }
        
        .tab-content { display: none; width: 100%; max-width: 850px; }
        .tab-content.active { display: block; }

        .grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 12px; width: 100%; }
        .special-grid { grid-template-columns: repeat(3, 1fr) !important; }
        
        .card {
            aspect-ratio: 1 / 1;
            background: white;
            border-radius: 12px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            text-align: center;
            border: 2px solid #eee;
            position: relative;
            transition: all 0.1s;
        }
        .card:active { transform: scale(0.95); border-color: var(--primary-color); }

        /* Đổi màu chữ xen kẽ */
        .card:nth-child(odd) .kana { color: var(--char-color-1); }
        .card:nth-child(even) .kana { color: var(--char-color-2); }
        
        .kana { font-size: 2.8rem; font-weight: bold; line-height: 1.1; }
        .romaji { font-size: 0.9rem; color: #888; font-weight: normal; }
        
        .vocab-box { display: none; padding: 5px; animation: fadeIn 0.2s; }
        .vocab { font-size: 1.2rem; font-weight: bold; color: #333; }
        .mean { font-size: 0.9rem; color: #666; margin-top: 4px; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .settings-panel {
            position: fixed; bottom: 20px; right: 20px;
            background: white; padding: 15px; border-radius: 15px;
            box-shadow: 0 5px 25px rgba(0,0,0,0.1); width: 230px; z-index: 100;
        }
        .settings-panel h3 { margin: 0 0 10px 0; font-size: 1rem; border-bottom: 2px solid #eee; padding-bottom: 5px; }
        .setting-item { margin-bottom: 10px; }
        label { display: block; font-size: 0.8rem; color: #666; margin-bottom: 3px; }
        select, input { width: 100%; padding: 5px; border-radius: 6px; border: 1px solid #ddd; font-size: 0.85rem; }
    </style>
</head>
<body>

    <div class="tabs">
        <button class="tab-btn active" onclick="openTab(0)">清音（せいおん</button>
        <button class="tab-btn" onclick="openTab(1)">濁音（だくおん）</button>
        <button class="tab-btn" onclick="openTab(2)">拗音（ようおん）</button>
    </div>

    <div id="tab0" class="tab-content active"><div class="grid" id="grid0"></div></div>
    <div id="tab1" class="tab-content"><div class="grid" id="grid1"></div></div>
    <div id="tab2" class="tab-content"><div class="grid special-grid" id="grid2"></div></div>

    <div class="settings-panel">
        <h3>設定 (Cài đặt)</h3>
        <div class="setting-item">
            <label>再生モード:</label>
            <select id="mode">
                <option value="ja">日本語のみ</option>
                <option value="ja-vi">日本語 ➔ ベトナム語</option>
            </select>
        </div>
        <div class="setting-item">
            <label>速度: <span id="speed-val">1</span></label>
            <input type="range" id="speed" min="0.5" max="1.5" step="0.1" value="1">
        </div>
        <div class="setting-item">
            <label>日本語の声:</label>
            <select id="voice-ja"></select>
        </div>
        <div class="setting-item">
            <label>ベトナム語の声:</label>
            <select id="voice-vi"></select>
        </div>
    </div>

    <script>
        const data = [
            // Tab 0: Seion
            [
                {k:"あ", r:"a", v:"あり", m:"Con kiến"}, {k:"い", r:"i", v:"いぬ", m:"Con chó"}, {k:"う", r:"u", v:"うし", m:"Con bò"}, {k:"え", r:"e", v:"えんぴつ", m:"Bút chì"}, {k:"お", r:"o", v:"おに", m:"Con quỷ"},
                {k:"か", r:"ka", v:"かめ", m:"Con rùa"}, {k:"き", r:"ki", v:"きつね", m:"Con cáo"}, {k:"く", r:"ku", v:"くま", m:"Con gấu"}, {k:"け", r:"ke", v:"けむり", m:"Khói"}, {k:"こ", r:"ko", v:"こま", m:"Cái quay"},
                {k:"さ", r:"sa", v:"さかな", m:"Con cá"}, {k:"し", r:"shi", v:"しか", m:"Con hươu"}, {k:"す", r:"su", v:"すいか", m:"Dưa hấu"}, {k:"せ", r:"se", v:"せみ", m:"Con ve"}, {k:"そ", r:"so", v:"そら", m:"Bầu trời"},
                {k:"た", r:"ta", v:"たこ", m:"Bạch tuộc"}, {k:"ち", r:"chi", v:"ちず", m:"Bản đồ"}, {k:"つ", r:"tsu", v:"つくえ", m:"Cái bàn"}, {k:"て", r:"te", v:"てがみ", m:"Bức thư"}, {k:"と", r:"to", v:"とら", m:"Con hổ"},
                {k:"な", r:"na", v:"なす", m:"Cà tím"}, {k:"に", r:"ni", v:"にじ", m:"Cầu vồng"}, {k:"ぬ", r:"nu", v:"ぬの", m:"Vải"}, {k:"ね", r:"ne", v:"ねこ", m:"Con mèo"}, {k:"の", r:"no", v:"のり", m:"Rong biển"},
                {k:"は", r:"ha", v:"はな", m:"Hoa"}, {k:"ひ", r:"hi", v:"ひこうき", m:"Máy bay"}, {k:"ふ", r:"fu", v:"ふね", m:"Con thuyền"}, {k:"へ", r:"he", v:"へび", m:"Con rắn"}, {k:"ほ", r:"ho", v:"ほし", m:"Ngôi sao"},
                {k:"ま", r:"ma", v:"まど", m:"Cửa sổ"}, {k:"み", r:"mi", v:"みかん", m:"Quả quýt"}, {k:"む", r:"mu", v:"むし", m:"Côn trùng"}, {k:"め", r:"me", v:"めがね", m:"Mắt kính"}, {k:"も", r:"mo", v:"もち", m:"Bánh dày"},
                {k:"や", r:"ya", v:"やま", m:"Núi"}, {k:"", r:"", v:"", m:""}, {k:"ゆ", r:"yu", v:"ゆき", m:"Tuyết"}, {k:"", r:"", v:"", m:""}, {k:"よ", r:"yo", v:"よる", m:"Ban đêm"},
                {k:"ら", r:"ra", v:"らいおん", m:"Sư tử"}, {k:"り", r:"ri", v:"りんご", m:"Quả táo"}, {k:"る", r:"ru", v:"るす", m:"Vắng nhà"}, {k:"れ", r:"re", v:"れいぞうこ", m:"Tủ lạnh"}, {k:"ろ", r:"ro", v:"ろうそく", m:"Nến"},
                {k:"わ", r:"wa", v:"わに", m:"Cá sấu"}, {k:"", r:"", v:"", m:""}, {k:"", r:"", v:"", m:""}, {k:"", r:"", v:"", m:""}, {k:"を", r:"wo", v:"を", m:"Trợ từ"},
                {k:"ん", r:"n", v:"きりん", m:"Hươu cao cổ"}
            ],
            // Tab 1: Dakuon
            [
                {k:"が", r:"ga", v:"がっこう", m:"Trường học"}, {k:"ぎ", r:"gi", v:"ぎんこう", m:"Ngân hàng"}, {k:"ぐ", r:"gu", v:"ぐんて", m:"Găng tay"}, {k:"げ", r:"ge", v:"げんき", m:"Khỏe mạnh"}, {k:"ご", r:"go", v:"ごはん", m:"Cơm"},
                {k:"ざ", r:"za", v:"ざっし", m:"Tạp chí"}, {k:"じ", r:"ji", v:"じしん", m:"Động đất"}, {k:"ず", r:"zu", v:"ずかん", m:"Sách ảnh"}, {k:"ぜ", r:"ze", v:"ぜんぶ", m:"Tất cả"}, {k:"ぞ", r:"zo", v:"ぞう", m:"Con voi"},
                {k:"だ", r:"da", v:"だいこん", m:"Củ cải"}, {k:"ぢ", r:"ji", v:"はなぢ", m:"Chảy máu cam"}, {k:"づ", r:"zu", v:"つづく", m:"Tiếp tục"}, {k:"で", r:"de", v:"でんわ", m:"Điện thoại"}, {k:"ど", r:"do", v:"どあ", m:"Cửa"},
                {k:"ば", r:"ba", v:"ばんごう", m:"Số"}, {k:"び", r:"bi", v:"びん", m:"Cái chai"}, {k:"ぶ", r:"bu", v:"ぶた", m:"Con lợn"}, {k:"べ", r:"be", v:"べんきょう", m:"Học tập"}, {k:"ぼ", r:"bo", v:"ぼうし", m:"Mũ"},
                {k:"ぱ", r:"pa", v:"ぱん", m:"Bánh mì"}, {k:"ぴ", r:"pi", v:"ぴんせっと", m:"Cái nhíp"}, {k:"ぷ", r:"pu", v:"ぷれぜんと", m:"Quà tặng"}, {k:"ぺ", r:"pe", v:"ぺん", m:"Cái bút"}, {k:"ぽ", r:"po", v:"ぽすと", m:"Hộp thư"}
            ],
            // Tab 2: Yoon
            [
                {k:"きゃ", r:"kya", v:"きゃく", m:"Khách hàng"}, {k:"きゅ", r:"kyu", v:"きゅうり", m:"Dưa chuột"}, {k:"きょ", r:"kyo", v:"きょねん", m:"Năm ngoái"},
                {k:"しゃ", r:"sha", v:"しゃしん", m:"Ảnh"}, {k:"しゅ", r:"shu", v:"しゅくだい", m:"Bài tập"}, {k:"しょ", r:"sho", v:"しょくどう", m:"Nhà ăn"},
                {k:"ちゃ", r:"cha", v:"ちゃわん", m:"Cái bát"}, {k:"ちゅ", r:"chu", v:"ちゅうしゃ", m:"Tiêm"}, {k:"ちょ", r:"cho", v:"ちょきん", m:"Tiết kiệm"},
                {k:"にゃ", r:"nya", v:"にゃー", m:"Tiếng mèo"}, {k:"にゅ", r:"nyu", v:"にゅうがく", m:"Nhập học"}, {k:"にょ", r:"nyo", v:"にょう", m:"Nước tiểu"},
                {k:"ひゃ", r:"hya", v:"ひゃく", m:"Một trăm"}, {k:"ひゅ", r:"hyu", v:"ひゅう", m:"Gió thổi"}, {k:"ひょ", r:"hyo", v:"ひょう", m:"Con báo"},
                {k:"みゃ", r:"mya", v:"みゃく", m:"Mạch đập"}, {k:"みゅ", r:"myu", v:"みゅーじっく", m:"Âm nhạc"}, {k:"みょ", r:"myo", v:"みょうじ", m:"Họ"},
                {k:"りゃ", r:"rya", v:"りゃく", m:"Lược bớt"}, {k:"りゅ", r:"ryu", v:"りゅう", m:"Con rồng"}, {k:"りょ", r:"ryo", v:"りょこう", m:"Du lịch"},
                {k:"ぎゃ", r:"gya", v:"ぎゃく", m:"Ngược lại"}, {k:"ぎゅ", r:"gyu", v:"ぎゅうにゅう", m:"Sữa bò"}, {k:"ぎょ", r:"gyo", v:"ぎょぎょう", m:"Ngư nghiệp"},
                {k:"じゃ", r:"ja", v:"じゃがいも", m:"Khoai tây"}, {k:"じゅ", r:"ju", v:"じゅぎょう", m:"Tiết học"}, {k:"じょ", r:"jo", v:"じょし", m:"Con gái"},
                {k:"びゃ", r:"bya", v:"びゃくだん", m:"Đàn hương"}, {k:"びゅ", r:"byu", v:"びゅーん", m:"Vút qua"}, {k:"びょ", r:"byo", v:"びょういん", m:"Bệnh viện"},
                {k:"ぴゃ", r:"pya", v:"ぴゃっと", m:"Đột ngột"}, {k:"ぴゅ", r:"pyu", v:"ぴゅあ", m:"Trong sáng"}, {k:"ぴょ", r:"pyo", v:"ぴょんぴょん", m:"Nhảy"}
            ]
        ];

        let synth = window.speechSynthesis;
        let voices = [];

        function init() {
            setTimeout(() => {
                voices = synth.getVoices();
                const jaSelect = document.getElementById('voice-ja');
                const viSelect = document.getElementById('voice-vi');
                voices.forEach(v => {
                    if(v.lang.includes('ja')) jaSelect.add(new Option(v.name, v.name));
                    if(v.lang.includes('vi')) viSelect.add(new Option(v.name, v.name));
                });
            }, 500);

            data.forEach((tabData, tabIdx) => {
                const grid = document.getElementById(`grid${tabIdx}`);
                tabData.forEach(item => {
                    const card = document.createElement('div');
                    card.className = 'card';
                    if(!item.k) { card.style.visibility = 'hidden'; }
                    
                    card.innerHTML = `
                        <div class="char-box">
                            <div class="kana">${item.k}</div>
                            <div class="romaji">${item.r}</div>
                        </div>
                        <div class="vocab-box">
                            <div class="vocab">${item.v}</div>
                            <div class="mean">${item.m}</div>
                        </div>
                    `;
                    
                    card.onclick = () => {
                        synth.cancel(); // Ngắt ngay để đọc chữ tiếp theo
                        const charBox = card.querySelector('.char-box');
                        const vocabBox = card.querySelector('.vocab-box');
                        charBox.style.display = 'none';
                        vocabBox.style.display = 'block';
                        speak(item);
                        setTimeout(() => {
                            charBox.style.display = 'block';
                            vocabBox.style.display = 'none';
                        }, 2000);
                    };
                    grid.appendChild(card);
                });
            });
        }

        function speak(item) {
            const mode = document.getElementById('mode').value;
            const rate = document.getElementById('speed').value;
            let utterJa = new SpeechSynthesisUtterance(`${item.k}, ${item.v}`);
            utterJa.voice = voices.find(v => v.name === document.getElementById('voice-ja').value);
            utterJa.rate = rate;
            utterJa.lang = 'ja-JP';
            synth.speak(utterJa);

            if(mode === 'ja-vi') {
                utterJa.onend = () => {
                    let utterVi = new SpeechSynthesisUtterance(item.m);
                    utterVi.voice = voices.find(v => v.name === document.getElementById('voice-vi').value);
                    utterVi.rate = rate;
                    utterVi.lang = 'vi-VN';
                    synth.speak(utterVi);
                };
            }
        }

        function openTab(idx) {
            document.querySelectorAll('.tab-btn').forEach((b, i) => b.classList.toggle('active', i === idx));
            document.querySelectorAll('.tab-content').forEach((c, i) => c.classList.toggle('active', i === idx));
        }

        document.getElementById('speed').oninput = (e) => document.getElementById('speed-val').innerText = e.target.value;
        init();
    </script>
</body>
</html>