<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>1000 Kanji - Chuẩn 5 Từ Gợi Ý</title>
    <style>
        :root { --bg: #f8f9fa; --txt: #2d3436; --accent: #0984e3; --card: #ffffff; }
        body { font-family: -apple-system, system-ui, sans-serif; background: var(--bg); color: var(--txt); margin: 0; padding: 10px; }

        /* Lưới ngoài 20x50 */
        .grid-container { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(45px, 1fr)); 
            gap: 5px; max-width: 1400px; margin: 0 auto;
        }
        @media (min-width: 1200px) { .grid-container { grid-template-columns: repeat(20, 1fr); } }

        .kanji-box { 
            background: var(--card); border: 1px solid #dfe6e9; aspect-ratio: 1/1;
            display: flex; align-items: center; justify-content: center; cursor: pointer;
            font-size: 3.0rem; position: relative; border-radius: 5px;
        }
        .stt { position: absolute; top: 1px; left: 2px; font-size: 0.55rem; color: #b2bec3; }

        /* Tab chi tiết */
        #overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg); display: none; z-index: 2000;
            flex-direction: column; align-items: center; overflow-y: auto; padding: 20px 0;
        }
        .content { background: white; padding: 20px; border-radius: 20px; width: 92%; max-width: 600px; text-align: center; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        .big-kanji { font-size: 7rem; margin: 10px 0; cursor: pointer; color: var(--txt); }

        /* Danh sách 5 từ gợi ý */
        .vocab-row { 
            display: grid; grid-template-columns: 1fr 1fr 1.5fr; 
            padding: 12px; margin-bottom: 8px; background: #f1f2f6; 
            border-radius: 10px; cursor: pointer; text-align: left;
            border-left: 5px solid var(--accent);
        }
        .v-kanji { font-weight: bold; }
        .v-hira { color: #636e72; font-size: 0.95rem; }
        .v-mean { color: var(--accent); font-size: 0.95rem; }

        /* Slide Menu */
        #menu { position: fixed; top: 0; right: -300px; width: 260px; height: 100%; background: #fff; padding: 20px; box-shadow: -5px 0 15px rgba(0,0,0,0.1); transition: 0.3s; z-index: 2001; }
        #menu.open { right: 0; }
        .btn-toggle { position: fixed; top: 15px; right: 15px; z-index: 2002; width: 45px; height: 45px; background: var(--accent); color: white; border: none; border-radius: 50%; cursor: pointer; }
        .hidden { display: none !important; }
    </style>
</head>
<body>

<button class="btn-toggle" onclick="document.getElementById('menu').classList.toggle('open')">☰</button>

<div id="menu">
    <h3>Cài đặt</h3>
    <label>Màu chữ: <input type="color" id="cTxt" value="#2d3436"></label><br><br>
    <label>Màu nền: <input type="color" id="cBg" value="#f8f9fa"></label><br><br>
    <label>Tốc độ: <input type="range" id="rate" min="0.5" max="1.2" step="0.1" value="0.8"></label><hr>
    <label>Giọng Nhật: <select id="vJa" style="width:100%"></select></label><br><br>
    <label>Giọng Việt: <select id="vVi" style="width:100%"></select></label><hr>
    <label><input type="checkbox" id="showV" checked> Hiện từ vựng</label><br><br>
    <label>Chế độ: 
        <select id="mode">
            <option value="ja">Chỉ tiếng Nhật</option>
            <option value="javi" selected>Nhật - Việt</option>
        </select>
    </label>
</div>

<div class="grid-container" id="grid"></div>

<div id="overlay">
    <button onclick="closeOverlay()" style="margin-bottom:15px; padding:10px 30px; border-radius:20px; border:none; background:#dfe6e9;">Đóng</button>
    <div class="content">
        <h1 class="big-kanji" id="mainK" onclick="speakKunOnly()"></h1>
        <p style="color:#b2bec3; font-size:0.8rem;">Chỉ đọc âm KUN khi nhấn vào đây</p>
        <h3 id="readK" style="font-weight:normal; color:#636e72; border-bottom:1px solid #eee; padding-bottom:10px;"></h3>
        
        <div id="vocabSection">
            <!-- Đảm bảo hiển thị đủ 5 dòng -->
            <div id="listV"></div>
        </div>
    </div>
</div>

<script>
    // Dữ liệu mẫu CHUẨN 5 TỪ VỰNG mỗi chữ
    const kanjiData = [
         
       {k: "一", on: "イチ", kun: "ひとつ", v: "Số một", vocab: [["一つ", "ひとつ", "Một cái"], ["一人", "ひとり", "Một người"], ["一日", "ついたち", "Ngày mùng 1"], ["一番", "いちばん", "Số một, nhất"], ["一月", "いちがつ", "Tháng 1"]]},
{k: "二", on: "ニ", kun: "ふたつ", v: "Số hai", vocab: [["二つ", "ふたつ", "Hai cái"], ["二人", "ふたり", "Hai người"], ["二日", "ふつか", "Ngày mùng 2"], ["二月", "にがつ", "Tháng 2"], ["二歳", "にさい", "2 tuổi"]]},
{k: "三", on: "サン", kun: "みっつ", v: "Số ba", vocab: [["三つ", "みっつ", "Ba cái"], ["三日", "みっか", "Ngày mùng 3"], ["三月", "さんがつ", "Tháng 3"], ["三人", "さんにん", "Ba người"], ["三角形", "さんかっけい", "Hình tam giác"]]},
{k: "四", on: "シ", kun: "よっつ", v: "Số bốn", vocab: [["四つ", "よっつ", "Bốn cái"], ["四日", "よっか", "Ngày mùng 4"], ["四月", "しがつ", "Tháng 4"], ["四角", "しかく", "Hình vuông"], ["四季", "しき", "Bốn mùa"]]},
{k: "五", on: "ゴ", kun: "いつつ", v: "Số năm", vocab: [["五つ", "いつつ", "Năm cái"], ["五日", "いつか", "Ngày mùng 5"], ["五月", "ごがつ", "Tháng 5"], ["五輪", "ごりん", "Năm vòng tròn Olympic"], ["五感", "ごかん", "Năm giác quan"]]},
{k: "六", on: "ロク", kun: "むっつ", v: "Số sáu", vocab: [["六つ", "むっつ", "Sáu cái"], ["六日", "むいか", "Ngày mùng 6"], ["六月", "ろくがつ", "Tháng 6"], ["六角形", "ろっかっけい", "Hình lục giác"], ["六人", "ろくにん", "Sáu người"]]},
{k: "七", on: "シチ", kun: "ななつ", v: "Số bảy", vocab: [["七つ", "ななつ", "Bảy cái"], ["七日", "なのか", "Ngày mùng 7"], ["七月", "しちがつ", "Tháng 7"], ["七夕", "たなばた", "Lễ Thất tịch"], ["七分", "しちぶ", "Bảy phần"]]},
{k: "八", on: "ハチ", kun: "やっつ", v: "Số tám", vocab: [["八つ", "やっつ", "Tám cái"], ["八日", "ようか", "Ngày mùng 8"], ["八月", "はちがつ", "Tháng 8"], ["八百屋", "やおや", "Cửa hàng rau"], ["八歳", "はっさい", "8 tuổi"]]},
{k: "九", on: "キュウ", kun: "ここのつ", v: "Số chín", vocab: [["九つ", "ここのつ", "Chín cái"], ["九日", "ここのか", "Ngày mùng 9"], ["九月", "くがつ", "Tháng 9"], ["九州", "きゅうしゅう", "Đảo Cửu Châu"], ["九九", "くく", "Bảng cửu chương"]]},
{k: "十", on: "ジュウ", kun: "とお", v: "Số mười", vocab: [["十", "とお", "Mười"], ["十日", "とおか", "Ngày mùng 10"], ["十月", "じゅうがつ", "Tháng 10"], ["十分", "じゅうぶん", "Đầy đủ"], ["十字架", "じゅうじか", "Thánh giá"]]},
{k: "百", on: "ヒャク", kun: "もも", v: "Một trăm", vocab: [["百", "ひゃく", "Một trăm"], ["三百", "さんびゃく", "Ba trăm"], ["六百", "ろっぴゃく", "Sáu trăm"], ["八百", "はっぴゃく", "Tám trăm"], ["百科事典", "ひゃっかじてん", "Bách khoa toàn thư"]]},
{k: "千", on: "セン", kun: "ち", v: "Một nghìn", vocab: [["千", "せん", "Một nghìn"], ["三千", "さんぜん", "Ba nghìn"], ["千円", "せんえん", "Một nghìn Yên"], ["千葉県", "ちばけん", "Tỉnh Chiba"], ["千切り", "ちぎり", "Thái sợi"]]},
{k: "上", on: "ジョウ", kun: "うえ・あがる", v: "Phía trên, bên trên", vocab: [["上", "うえ", "Phía trên"], ["上手", "じょうず", "Giỏi"], ["上着", "うわぎ", "Áo khoác"], ["屋上", "おくじょう", "Sân thượng"], ["上る", "のぼる", "Leo lên"]]},
{k: "下", on: "カ", kun: "した・さがる", v: "Phía dưới, bên dưới", vocab: [["下", "した", "Phía dưới"], ["下手", "へた", "Dở, kém"], ["地下鉄", "ちかてつ", "Tàu điện ngầm"], ["下着", "したぎ", "Quần áo lót"], ["下がる", "さがる", "Hạ xuống"]]},
{k: "左", on: "サ", kun: "ひだり", v: "Bên trái", vocab: [["左", "ひだり", "Bên trái"], ["左側", "ひだりがわ", "Phía bên trái"], ["左手", "ひだりて", "Tay trái"], ["左折", "させつ", "Rẽ trái"], ["左利き", "ひだりきき", "Thuận tay trái"]]},
{k: "右", on: "ウ", kun: "みぎ", v: "Bên phải", vocab: [["右", "みぎ", "Bên phải"], ["右側", "みぎがわ", "Phía bên phải"], ["右手", "みぎて", "Tay phải"], ["右折", "うせつ", "Rẽ phải"], ["左右", "さゆう", "Trái phải"]]},
{k: "中", on: "チュウ", kun: "なか", v: "Bên trong, ở giữa", vocab: [["中", "なか", "Bên trong"], ["中心", "ちゅうしん", "Trung tâm"], ["中国", "ちゅうごく", "Trung Quốc"], ["中学校", "ちゅうがっこう", "Trường cấp 2"], ["一日中", "いちにちじゅう", "Suốt cả ngày"]]},
{k: "大", on: "ダイ", kun: "おおきい", v: "To, lớn", vocab: [["大きい", "おおきい", "Lớn"], ["大学", "だいがく", "Trường đại học"], ["大人", "おとな", "Người lớn"], ["大切", "たいせつ", "Quan trọng"], ["大会", "たいかい", "Đại hội"]]},
{k: "小", on: "ショウ", kun: "ちいさい", v: "Nhỏ, bé", vocab: [["小さい", "ちいさい", "Nhỏ"], ["小学校", "しょうがっこう", "Trường tiểu học"], ["小学生", "しょうがくせい", "Học sinh tiểu học"], ["小包", "こづつmi", "Bưu kiện nhỏ"], ["小川", "おがわ", "Suối nhỏ"]]},
{k: "月", on: "ゲツ", kun: "つき", v: "Mặt trăng, tháng", vocab: [["月", "つき", "Mặt trăng"], ["月曜日", "げつようび", "Thứ hai"], ["今月", "こんげつ", "Tháng này"], ["一月", "いちがつ", "Tháng một"], ["毎月", "まいつき", "Hàng tháng"]]},
{k: "日", on: "ニチ", kun: "ひ・か", v: "Ngày, mặt trời", vocab: [["日", "ひ", "Ngày, mặt trời"], ["日曜日", "にちようび", "Chủ nhật"], ["日本", "にほん", "Nhật Bản"], ["毎日", "まいにち", "Hàng ngày"], ["誕生日", "たんじょうび", "Sinh nhật"]]},
{k: "火", on: "カ", kun: "ひ", v: "Lửa", vocab: [["火", "ひ", "Lửa"], ["火曜日", "かようび", "Thứ ba"], ["火山", "かざん", "Núi lửa"], ["火事", "かじ", "Hỏa hoạn"], ["花火", "はなび", "Pháo hoa"]]},
{k: "水", on: "スイ", kun: "みず", v: "Nước", vocab: [["水", "みず", "Nước"], ["水曜日", "すいようび", "Thứ tư"], ["水道", "すいどう", "Nước máy"], ["水泳", "すいえい", "Bơi lội"], ["水着", "みずぎ", "Đồ bơi"]]},
{k: "木", on: "モク", kun: "き", v: "Cây cối", vocab: [["木", "き", "Cây"], ["木曜日", "もくようび", "Thứ năm"], ["大木", "たいぼく", "Cây lớn"], ["木材", "もくざい", "Gỗ"], ["栃木県", "とちぎけん", "Tỉnh Tochigi"]]},
{k: "金", on: "キン", kun: "かね", v: "Tiền, vàng", vocab: [["お金", "おかね", "Tiền"], ["金曜日", "きんようび", "Thứ sáu"], ["金メダル", "キンメダル", "Huy chương vàng"], ["金持ち", "かねもち", "Người giàu"], ["現金", "げんきん", "Tiền mặt"]]},
{k: "土", on: "ド", kun: "つち", v: "Đất", vocab: [["土", "つち", "Đất"], ["土曜日", "どようび", "Thứ bảy"], ["土地", "とち", "Đất đai"], ["お土産", "おみやげ", "Quà lưu niệm"], ["粘土", "ねんど", "Đất sét"]]},
{k: "年", on: "ネン", kun: "とし", v: "Năm", vocab: [["年", "とし", "Năm"], ["今年", "ことし", "Năm nay"], ["去年", "きょねん", "Năm ngoái"], ["来年", "らいねん", "Sang năm"], ["半年", "はんとし", "Nửa năm"]]},
{k: "早", on: "ソウ", kun: "はやい", v: "Sớm", vocab: [["早い", "はやい", "Sớm"], ["早口", "はやくち", "Nói nhanh"], ["早朝", "そうちょう", "Sáng sớm"], ["早速", "さっそく", "Ngay lập tức"], ["早退", "そうたい", "Về sớm"]]},
{k: "気", on: "キ", kun: "いき", v: "Khí thế, tinh thần", vocab: [["元気", "げんき", "Khỏe mạnh"], ["天気", "てんき", "Thời tiết"], ["気持ち", "きもち", "Cảm giác"], ["人気", "にんき", "Nổi tiếng"], ["気分", "きぶん", "Tâm trạng"]]},
{k: "空", on: "クウ", kun: "そら・あく", v: "Bầu trời, trống rỗng", vocab: [["空", "そら", "Bầu trời"], ["空気", "くうき", "Không khí"], ["空港", "くうこう", "Sân bay"], ["空手", "からて", "Võ Karate"], ["空く", "あく", "Trống, vắng"]]},
{k: "山", on: "サン", kun: "やま", v: "Núi", vocab: [["山", "やま", "Núi"], ["富士山", "ふじさん", "Núi Phú Sĩ"], ["登山", "とざん", "Leo núi"], ["山道", "やまみち", "Đường núi"], ["山田", "やまだ", "Họ Yamada"]]},
{k: "川", on: "セン", kun: "かわ", v: "Sông", vocab: [["川", "かわ", "Sông"], ["小川", "おがわ", "Suối nhỏ"], ["河川", "かせん", "Sông ngòi"], ["川岸", "かわぎし", "Bờ sông"], ["中川", "なかがわ", "Họ Nakagawa"]]},
{k: "林", on: "リン", kun: "はやし", v: "Rừng thưa", vocab: [["林", "はやし", "Rừng thưa"], ["森林", "しんりん", "Rừng rậm"], ["林道", "りんどう", "Đường rừng"], ["小林", "こばやし", "Họ Kobayashi"], ["山林", "さんりん", "Sơn lâm"]]},
{k: "森", on: "シン", kun: "もり", v: "Rừng rậm", vocab: [["森", "もり", "Rừng"], ["青森県", "あおもりけん", "Tỉnh Aomori"], ["森林", "しんりん", "Rừng rậm"], ["森田", "もりた", "Họ Morita"], ["森の中", "もりのなか", "Trong rừng"]]},
{k: "竹", on: "チク", kun: "たけ", v: "Cây tre", vocab: [["竹", "たけ", "Cây tre"], ["竹の子", "たけのこ", "Măng"], ["竹林", "ちくりん", "Rừng tre"], ["竹竿", "たけざお", "Cần câu tre"], ["竹細工", "たけざいく", "Đồ tre đan"]]},
{k: "草", on: "ソウ", kun: "くさ", v: "Cỏ", vocab: [["草", "くさ", "Cỏ"], ["雑草", "ざっそう", "Cỏ dại"], ["草食", "そうしょく", "Ăn cỏ"], ["草原", "くさはら", "Đồng cỏ"], ["芝草", "しばくさ", "Cỏ nhung"]]},
{k: "花", on: "カ", kun: "はな", v: "Hoa", vocab: [["花", "はna", "Hoa"], ["花火", "はなび", "Pháo hoa"], ["花瓶", "かびん", "Lọ hoa"], ["生け花", "いけばな", "Nghệ thuật cắm hoa"], ["花屋", "はなや", "Cửa hàng hoa"]]},
{k: "貝", on: "バイ", kun: "かい", v: "Con sò, vỏ sò", vocab: [["貝", "かい", "Con sò"], ["貝殻", "かいがら", "Vỏ sò"], ["赤貝", "あかがい", "Sò huyết"], ["巻貝", "まきがい", "Ốc xoắn"], ["ムール貝", "ムールがい", "Con vẹm"]]},
{k: "虫", on: "チュウ", kun: "むし", v: "Côn trùng, sâu bọ", vocab: [["虫", "むし", "Sâu bọ"], ["弱虫", "よわむし", "Kẻ yếu đuối"], ["昆虫", "こんちゅう", "Côn trùng"], ["泣き虫", "なきむし", "Đứa trẻ hay khóc"], ["虫歯", "むしば", "Răng sâu"]]},
{k: "犬", on: "ケン", kun: "いぬ", v: "Con chó", vocab: [["犬", "いぬ", "Con chó"], ["子犬", "こいぬ", "Chó con"], ["番犬", "ばんけん", "Chó giữ nhà"], ["柴犬", "しばいぬ", "Chó Shiba"], ["盲導犬", "もうどうけん", "Chó dẫn đường"]]},
{k: "目", on: "モク", kun: "め", v: "Mắt", vocab: [["目", "め", "Mắt"], ["目次", "もくじ", "Mục lục"], ["目的", "もくてき", "Mục đích"], ["目薬", "めぐすり", "Thuốc nhỏ mắt"], ["目印", "めじるし", "Dấu hiệu"]]},
{k: "耳", on: "ジ", kun: "みみ", v: "Tai", vocab: [["耳", "みみ", "Cái tai"], ["耳鳴り", "みみなり", "Ù tai"], ["耳鼻科", "じびか", "Khoa tai mũi họng"], ["耳打ち", "みみうち", "Nói thầm"], ["耳飾り", "みみかざり", "Hoa tai"]]},
{k: "口", on: "コウ", kun: "くち", v: "Miệng", vocab: [["口", "くち", "Cái miệng"], ["入口", "いりぐち", "Lối vào"], ["人口", "じんこう", "Dân số"], ["窓口", "まどぐち", "Cửa bán vé"], ["悪口", "わるぐち", "Nói xấu"]]},
{k: "手", on: "シュ", kun: "て", v: "Bàn tay", vocab: [["手", "て", "Bàn tay"], ["上手", "じょうず", "Giỏi"], ["手紙", "てがみ", "Bức thư"], ["切手", "きって", "Tem"], ["運転手", "うんてんしゅ", "Tài xế"]]},
{k: "足", on: "ソク", kun: "あし・たりる", v: "Chân, đầy đủ", vocab: [["足", "あし", "Cái chân"], ["足りる", "たりる", "Đủ"], ["遠足", "えんそく", "Dã ngoại"], ["不足", "ふそく", "Thiếu hụt"], ["一足", "いっそく", "Một đôi giày"]]},
{k: "力", on: "リョク", kun: "ちから", v: "Sức mạnh, sức lực", vocab: [["力", "ちから", "Sức lực"], ["協力", "きょうりょく", "Hợp tác"], ["努力", "どりょく", "Nỗ lực"], ["体力", "たいりょく", "Thể lực"], ["実力", "じつりょく", "Thực lực"]]},
{k: "名", on: "メイ", kun: "な", v: "Tên", vocab: [["名前", "なまえ", "Tên"], ["有名", "ゆうめい", "Nổi tiếng"], ["名字", "みょうじ", "Họ"], ["名刺", "めいし", "Danh thiếp"], ["地名", "ちめい", "Địa danh"]]},
{k: "女", on: "ジョ", kun: "おんな", v: "Phụ nữ, con gái", vocab: [["女", "おんな", "Phụ nữ"], ["女の子", "おんなのこ", "Bé gái"], ["彼女", "かのじょ", "Cô ấy, bạn gái"], ["女神", "めがみ", "Nữ thần"], ["長女", "ちょうじょ", "Trưởng nữ"]]},
{k: "男", on: "ダン", kun: "おとこ", v: "Đàn ông, con trai", vocab: [["男", "おotoko", "Đàn ông"], ["男の子", "おとこのこ", "Bé trai"], ["長男", "ちょうなん", "Trưởng nam"], ["男子", "だんし", "Nam giới"], ["男性", "だんせい", "Phái nam"]]},
{k: "子", on: "シ", kun: "こ", v: "Con cái, đứa trẻ", vocab: [["子供", "こども", "Trẻ em"], ["息子", "むすこ", "Con trai"], ["様子", "ようす", "Tình hình"], ["椅子", "いす", "Cái ghế"], ["電子", "でんし", "Điện tử"]]},
{k: "出", on: "シュツ", kun: "でる・だす", v: "Ra ngoài, lấy ra", vocab: [["出る", "でる", "Đi ra"], ["出す", "だす", "Lấy ra"], ["出口", "でぐち", "Lối ra"], ["外出", "がいしゅつ", "Đi ra ngoài"], ["思い出", "おもいで", "Kỷ niệm"]]},
{k: "入", on: "ニュウ", kun: "はいる・いれる", v: "Vào trong, cho vào", vocab: [["入る", "はいる", "Đi vào"], ["入れる", "いれる", "Cho vào"], ["入口", "いりぐち", "Lối vào"], ["入学", "にゅうがく", "Nhập học"], ["気に入る", "きにいる", "Yêu thích"]]},
{k: "立", on: "リツ", kun: "たつ", v: "Đứng", vocab: [["立つ", "たつ", "Đứng"], ["国立", "こくりつ", "Quốc lập"], ["目立つ", "めだつ", "Nổi bật"], ["役に立つ", "やくにたつ", "Có ích"], ["立場", "たちば", "Lập trường"]]},
{k: "休", on: "キュウ", kun: "やすむ", v: "Nghỉ ngơi", vocab: [["休む", "やすむ", "Nghỉ ngơi"], ["休み", "やすみ", "Ngày nghỉ"], ["休日", "きゅうじつ", "Ngày nghỉ"], ["夏休み", "なつやすみ", "Nghỉ hè"], ["一休み", "ひとやすみ", "Nghỉ một lát"]]},
{k: "先", on: "セン", kun: "さき", v: "Trước đây, phía trước", vocab: [["先生", "せんせい", "Giáo viên"], ["先月", "せんげつ", "Tháng trước"], ["先週", "せんしゅう", "Tuần trước"], ["先に", "さきに", "Trước đây"], ["先頭", "せんとう", "Dẫn đầu"]]},
{k: "生", on: "セイ", kun: "いきる・うまれる", v: "Sống, sinh ra", vocab: [["生きる", "いきる", "Sống"], ["生まれる", "うまれる", "Sinh ra"], ["学生", "がくせい", "Học sinh"], ["生活", "せいかつ", "Cuộc sống"], ["一生", "いっしょう", "Cả đời"]]},
{k: "学", on: "ガク", kun: "まなぶ", v: "Học tập", vocab: [["学ぶ", "まなぶ", "Học"], ["学校", "がっこう", "Trường học"], ["学生", "がくせい", "Học sinh"], ["学習", "がくしゅう", "Học tập"], ["奨学金", "しょうがくきん", "Học bổng"]]},
{k: "校", on: "コウ", kun: "かせ", v: "Trường học", vocab: [["学校", "가っこう", "Trường học"], ["校長", "こうちょう", "Hiệu trưởng"], ["高校", "こうこう", "Trường cấp 3"], ["中学校", "ちゅうがっこう", "Trường cấp 2"], ["校内", "こうない", "Trong trường"]]},
{k: "本", on: "ホン", kun: "もと", v: "Sách, nguồn gốc", vocab: [["本", "ほん", "Sách"], ["日本", "にほん", "Nhật Bản"], ["本当", "ほんとう", "Thật sự"], ["日本語", "にほんご", "Tiếng Nhật"], ["山本", "やまもと", "Họ Yamamoto"]]},
{k: "文", on: "ブン", kun: "ふみ", v: "Văn chương, chữ viết", vocab: [["文字", "もじ", "Chữ cái"], ["文学", "ぶんがく", "Văn học"], ["作文", "さくぶん", "Bài tập làm văn"], ["文章", "ぶんしょう", "Đoạn văn"], ["文法", "ぶんぽう", "Ngữ pháp"]]},
{k: "字", on: "ジ", kun: "あざ", v: "Chữ cái, ký tự", vocab: [["漢字", "かんじ", "Hán tự"], ["数字", "すうじ", "Chữ số"], ["名字", "みょうじ", "Họ"], ["赤字", "あかじ", "Thâm hụt (lỗ)"], ["習字", "しゅうじ", "Luyện chữ"]]},
{k: "円", on: "エン", kun: "まるい", v: "Tiền Yên Nhật, hình tròn", vocab: [["円", "えん", "Tiền Yên"], ["円い", "まるい", "Tròn"], ["一万円", "いちまんえん", "Một vạn Yên"], ["円高", "えんだか", "Yên tăng giá"], ["円満", "えんまん", "Viên mãn"]]},
{k: "玉", on: "ギョク", kun: "たま", v: "Viên ngọc, hạt tròn", vocab: [["玉", "たま", "Hạt, bóng"], ["お年玉", "おとしだま", "Tiền lì xì"], ["百円玉", "ひゃくえんだま", "Đồng 100 Yên"], ["目玉", "めだま", "Nhãn cầu"], ["玉ねぎ", "たまねぎ", "Hành tây"]]},
{k: "王", on: "オウ", kun: "きみ", v: "Vua", vocab: [["王", "おう", "Vua"], ["王子", "おうじ", "Hoàng tử"], ["王女", "おうじょ", "Công chúa"], ["国王", "こくおう", "Quốc vương"], ["女王", "じょおう", "Nữ hoàng"]]},
{k: "糸", on: "シ", kun: "いと", v: "Sợi chỉ", vocab: [["糸", "いと", "Sợi chỉ"], ["毛糸", "けいと", "Len"], ["糸口", "いとぐち", "Gợi ý, đầu mối"], ["抜糸", "ばっし", "Cắt chỉ"], ["釣り糸", "つりいと", "Dây câu"]]},
{k: "車", on: "シャ", kun: "くるま", v: "Xe hơi, xe cộ", vocab: [["車", "くるま", "Xe hơi"], ["電車", "でんしゃ", "Tàu điện"], ["自転車", "じてんしゃ", "Xe đạp"], ["駐車場", "ちゅうしゃじょう", "Bãi đỗ xe"], ["自動車", "じどうしゃ", "Ô tô"]]},
{k: "石", on: "セキ", kun: "いし", v: "Hòn đá", vocab: [["石", "いし", "Hòn đá"], ["石油", "せきゆ", "Dầu mỏ"], ["宝石", "ほうせき", "Đá quý"], ["磁石", "じしゃく", "Nam châm"], ["化石", "かせき", "Hóa thạch"]]},
{k: "赤", on: "セキ", kun: "あかい", v: "Màu đỏ", vocab: [["赤い", "あかい", "Màu đỏ"], ["赤ちゃん", "あかちゃん", "Em bé"], ["赤道", "せきどう", "Đường xích đạo"], ["赤十字", "せきじゅうじ", "Chữ thập đỏ"], ["赤字", "あかじ", "Lỗ/Thâm hụt"]]},
{k: "青", on: "セイ", kun: "あおい", v: "Màu xanh da trời", vocab: [["青い", "あおい", "Màu xanh"], ["青空", "あおぞら", "Bầu trời xanh"], ["青年", "せいねん", "Thanh niên"], ["青森", "あおもり", "Tỉnh Aomori"], ["青信号", "あおしんごう", "Đèn xanh"]]},
{k: "白", on: "ハク", kun: "しろい", v: "Màu trắng", vocab: [["白い", "しろい", "Màu trắng"], ["面白い", "おもしろい", "Thú vị"], ["白鳥", "はくちょう", "Thiên nga"], ["白人", "はくじん", "Người da trắng"], ["白髪", "しらが", "Tóc bạc"]]},
{k: "天", on: "テン", kun: "あま", v: "Trời, thiên đường", vocab: [["天気", "てんき", "Thời tiết"], ["天国", "てんごく", "Thiên đường"], ["天才", "てんさい", "Thiên tài"], ["天皇", "てんのう", "Thiên hoàng"], ["天ぷら", "てんぷら", "Món tẩm bột chiên"]]},
{k: "夕", on: "セキ", kun: "ゆう", v: "Buổi chiều tối", vocab: [["夕方", "ゆうがた", "Buổi chiều"], ["夕食", "ゆうしょく", "Bữa tối"], ["夕日", "ゆうひ", "Nắng chiều"], ["夕立", "ゆうだち", "Cơn mưa rào"], ["七夕", "たなばた", "Lễ Thất tịch"]]},
{k: "昼", on: "チュウ", kun: "ひる", v: "Ban trưa, ban ngày", vocab: [["昼", "ひる", "Buổi trưa"], ["昼ご飯", "ひるごはん", "Cơm trưa"], ["昼寝", "ひるね", "Ngủ trưa"], ["昼休み", "ひるやすみ", "Nghỉ trưa"], ["昼間", "ひるま", "Ban ngày"]]},
{k: "音", on: "オン", kun: "おと・ね", v: "Âm thanh", vocab: [["音", "おと", "Âm thanh"], ["音楽", "おんがく", "Âm nhạc"], ["本音", "ほんね", "Ý định thật sự"], ["足音", "あしおと", "Tiếng bước chân"], ["録音", "ろくおん", "Ghi âm"]]},
{k: "語", on: "ゴ", kun: "かたる", v: "Ngôn ngữ, kể chuyện", vocab: [["語る", "かたる", "Kể chuyện"], ["日本語", "にほんご", "Tiếng Nhật"], ["英語", "えいご", "Tiếng Anh"], ["単語", "たんご", "Từ vựng"], ["物語", "ものがたり", "Câu chuyện"]]},
{k: "田", on: "デン", kun: "た", v: "Ruộng lúa", vocab: [["田んぼ", "たんぼ", "Ruộng lúa"], ["田中", "たなか", "Họ Tanaka"], ["水田", "すいでん", "Ruộng lúa nước"], ["田舎", "いなか", "Quê hương"], ["成田空港", "なりたくうこう", "Sân bay Narita"]]},
{k: "町", on: "チョウ", kun: "まち", v: "Thị trấn, khu phố", vocab: [["町", "まち", "Thị trấn"], ["町長", "ちょうちょう", "Thị trưởng"], ["下町", "したまち", "Khu phố cổ"], ["隣の町", "となり の まち", "Thị trấn bên cạnh"], ["町中", "まちじゅう", "Khắp thị trấn"]]},
{k: "村", on: "ソン", kun: "むら", v: "Ngôi làng", vocab: [["村", "むら", "Ngôi làng"], ["村人", "むらびと", "Dân làng"], ["農村", "のうそん", "Nông thôn"], ["村長", "そんちょう", "Trưởng thôn"], ["木村", "きむら", "Họ Kimura"]]},
{k: "門", on: "モン", kun: "かど", v: "Cái cổng", vocab: [["門", "もん", "Cái cổng"], ["専門", "せんもん", "Chuyên môn"], ["校門", "こうもん", "Cổng trường"], ["名門", "めいもん", "Danh giá"], ["正門", "せいもん", "Cổng chính"]]}

    ];

    const synth = window.speechSynthesis;
    let voices = [];
    let currentItem = null;

    function init() {
        const g = document.getElementById('grid');
        for(let i=1; i<=80; i++) {
            const d = kanjiData[i-1] || {k: "字", on: "", kun: "", v: "", vocab: []};
            const box = document.createElement('div');
            box.className = 'kanji-box';
            box.innerHTML = `<span class="stt">${i}</span>${d.k}`;
            // LUỚI NGOÀI: KHÔNG ĐỌC
            box.onclick = () => openDetail(d); 
            g.appendChild(box);
        }
        loadVoices();
    }

    function loadVoices() {
        voices = synth.getVoices();
        const ja = document.getElementById('vJa'), vi = document.getElementById('vVi');
        ja.innerHTML = ''; vi.innerHTML = '';
        voices.forEach(v => {
            const opt = new Option(v.name, v.name);
            if(v.lang.includes('ja')) {
                ja.add(opt);
                if(v.name.includes('Kyoko')) ja.value = v.name; // Ưu tiên Kyoko
            }
            if(v.lang.includes('vi')) vi.add(opt.cloneNode(true));
        });
    }

    function speakDual(jaText, viText) {
        synth.cancel(); 
        const mode = document.getElementById('mode').value;
        const rate = document.getElementById('rate').value;

        const uJa = new SpeechSynthesisUtterance(jaText);
        uJa.rate = rate;
        uJa.voice = voices.find(v => v.name === document.getElementById('vJa').value);
        
        uJa.onend = () => {
            if(mode === 'javi' && viText) {
                const uVi = new SpeechSynthesisUtterance(viText);
                uVi.rate = rate;
                uVi.voice = voices.find(v => v.name === document.getElementById('vVi').value);
                synth.speak(uVi);
            }
        };
        synth.speak(uJa);
    }

    function speakKunOnly() {
        if(currentItem) speakDual(currentItem.kun, currentItem.v);
    }

    function openDetail(d) {
        currentItem = d;
        document.getElementById('overlay').style.display = 'flex';
        document.getElementById('mainK').innerText = d.k;
        document.getElementById('readK').innerText = `ON: ${d.on} | KUN: ${d.kun}`;
        
        const list = document.getElementById('listV');
        list.innerHTML = '';
        
        const isShow = document.getElementById('showV').checked;
        document.getElementById('vocabSection').className = isShow ? '' : 'hidden';

        if(isShow) {
            // Hiển thị tối đa 5 từ từ mảng vocab
            d.vocab.slice(0, 5).forEach(v => {
                const row = document.createElement('div');
                row.className = 'vocab-row';
                row.innerHTML = `<div class="v-kanji">${v[0]}</div><div class="v-hira">${v[1]}</div><div class="v-mean">${v[2]}</div>`;
                // CHỈ ĐỌC HIRAGANA (v[1]) VÀ NGHĨA (v[2])
                row.onclick = (e) => { e.stopPropagation(); speakDual(v[1], v[2]); };
                list.appendChild(row);
            });
        }
        // Tự động đọc khi mở tab (Âm Kun)
        setTimeout(() => { speakKunOnly(); }, 200);
    }

    function closeOverlay() { synth.cancel(); document.getElementById('overlay').style.display = 'none'; }

    if (speechSynthesis.onvoiceschanged !== undefined) speechSynthesis.onvoiceschanged = loadVoices;
    
    document.getElementById('cTxt').oninput = (e) => document.documentElement.style.setProperty('--txt', e.target.value);
    document.getElementById('cBg').oninput = (e) => document.documentElement.style.setProperty('--bg', e.target.value);
    
    init();
</script>
</body>
</html>