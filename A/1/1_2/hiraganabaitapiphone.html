<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„Å≤„Çâ„Åå„Å™ „Åä„Åë„ÅÑ„Åì</title>
    <link href="https://fonts.googleapis.com" rel="stylesheet">
    <style>
        :root { --primary: #ff9a9e; --bg: #fffaf0; --accent: #ffde7d; --correct: #c8e6c9; --wrong: #ffcdd2; }
        body {
            font-family: 'Kosugi Maru', sans-serif; background-color: var(--bg);
            margin: 0; display: flex; flex-direction: column; align-items: center;
            user-select: none; -webkit-tap-highlight-color: transparent;
        }
        header {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            width: 100%; padding: 15px 0; text-align: center;
            color: white; font-size: 22px; font-weight: bold; box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .tab-container { display: flex; margin: 15px 0; gap: 5px; flex-wrap: wrap; justify-content: center; }
        .tab {
            padding: 10px 15px; cursor: pointer; background: white;
            border: 2px solid var(--primary); border-radius: 20px; font-size: 14px; font-weight: bold;
        }
        .tab.active { background: var(--primary); color: white; }
        
        #game-container {
            width: 90%; max-width: 500px; background: white; min-height: 450px;
            padding: 20px; border-radius: 30px; border: 5px solid var(--accent);
            text-align: center; position: relative; display: flex; flex-direction: column;
        }
        .progress-bar { font-size: 18px; color: #ff6f61; margin-bottom: 10px; font-weight: bold; background: #fff5f5; padding: 5px; border-radius: 10px; }
        
        .audio-box {
            font-size: 80px; width: 120px; height: 120px; background: #fff5f5;
            border-radius: 50%; border: 4px dashed var(--primary);
            display: inline-flex; align-items: center; justify-content: center;
            margin: 10px auto 20px; cursor: pointer; animation: bounce 2s infinite;
        }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }

        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .option-btn {
            padding: 15px 5px; background: white; border: 3px solid #eee;
            border-radius: 15px; cursor: pointer; display: flex; flex-direction: column; align-items: center; transition: 0.2s;
        }
        .option-btn .char { font-size: 32px; color: #ff6f61; font-weight: bold; }
        .option-btn .emoji { font-size: 24px; }
        .option-btn .word { font-size: 13px; color: #777; font-weight: bold;}
        
        .option-btn.correct { background: var(--correct) !important; border-color: #4caf50; }
        .option-btn.wrong { background: var(--wrong) !important; border-color: #f44336; }

        #result-screen {
            display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: white; border-radius: 25px; flex-direction: column;
            align-items: center; justify-content: center; z-index: 10;
        }
        .btn-restart {
            margin-top: 20px; padding: 12px 30px; background: #ff6f61;
            color: white; border: none; border-radius: 25px; font-size: 18px; cursor: pointer; font-family: 'Kosugi Maru';
        }
        .message { margin-top: 15px; font-size: 18px; font-weight: bold; color: #ff4081; min-height: 25px; }
    </style>
</head>
<body>

<header>üå∏ „Å≤„Çâ„Åå„Å™ „Åä„Åë„ÅÑ„Åì üå∏</header>

<div class="tab-container">
    <div class="tab active" onclick="initGame('seion', this)">„Åõ„ÅÑ„Åä„Çì (46)</div>
    <div class="tab" onclick="initGame('dakuon', this)">„Å†„Åè„Åä„Çì (25)</div>
    <div class="tab" onclick="initGame('yoon', this)">„Çà„ÅÜ„Åä„Çì (33)</div>
</div>

<div id="game-container">
    <div id="result-screen">
        <div style="font-size: 80px;">üèÜ</div>
        <h2 id="result-title">„Çà„Åè„Åß„Åç„Åæ„Åó„ÅüÔºÅ</h2>
        <p id="result-msg">B·∫°n ƒë√£ thu·ªôc h·∫øt b·∫£ng n√†y r·ªìi!</p>
        <button class="btn-restart" onclick="location.reload()">„ÇÇ„ÅÜ„ÅÑ„Å°„Å© (L√†m l·∫°i)</button>
    </div>

    <div class="progress-bar">„ÅÆ„Åì„Çä (C√≤n l·∫°i): <span id="count">0</span> / <span id="total">0</span></div>
    <div class="audio-box" onclick="playCurrent()">üì¢</div>
    <div id="options" class="options-grid"></div>
    <div class="message" id="message"></div>
</div>

<script>
    const database = {
        seion: [
            {c:"„ÅÇ",e:"üêú",w:"„ÅÇ„Çä"},{c:"„ÅÑ",e:"üçì",w:"„ÅÑ„Å°„Åî"},{c:"„ÅÜ",e:"üê∞",w:"„ÅÜ„Åï„Åé"},{c:"„Åà",e:"‚úèÔ∏è",w:"„Åà„Çì„Å¥„Å§"},{c:"„Åä",e:"üëπ",w:"„Åä„Å´"},
            {c:"„Åã",e:"üê¢",w:"„Åã„ÇÅ"},{c:"„Åç",e:"üçÑ",w:"„Åç„ÅÆ„Åì"},{c:"„Åè",e:"üêª",w:"„Åè„Åæ"},{c:"„Åë",e:"üêõ",w:"„Åë„ÇÄ„Åó"},{c:"„Åì",e:"üé™",w:"„Åì„Åæ"},
            {c:"„Åï",e:"üêü",w:"„Åï„Åã„Å™"},{c:"„Åó",e:"ü¶å",w:"„Åó„Åã"},{c:"„Åô",e:"üçâ",w:"„Åô„ÅÑ„Åã"},{c:"„Åõ",e:"üßº",w:"„Åõ„Å£„Åë„Çì"},{c:"„Åù",e:"üç¶",w:"„Åù„Åµ„Å®"},
            {c:"„Åü",e:"üêô",w:"„Åü„Åì"},{c:"„Å°",e:"üå∑",w:"„Å°„ÇÖ„Éº„Çä„Å£„Å∑"},{c:"„Å§",e:"üåô",w:"„Å§„Åç"},{c:"„Å¶",e:"üíå",w:"„Å¶„Åå„Åø"},{c:"„Å®",e:"üêØ",w:"„Å®„Çâ"},
            {c:"„Å™",e:"üçÜ",w:"„Å™„Åô"},{c:"„Å´",e:"ü•ï",w:"„Å´„Çì„Åò„Çì"},{c:"„Å¨",e:"üêï",w:"„ÅÑ„Å¨"},{c:"„Å≠",e:"üê±",w:"„Å≠„Åì"},{c:"„ÅÆ",e:"üìì",w:"„ÅÆ„Éº„Å®"},
            {c:"„ÅØ",e:"üå∏",w:"„ÅØ„Å™"},{c:"„Å≤",e:"üêë",w:"„Å≤„Å§„Åò"},{c:"„Åµ",e:"üö¢",w:"„Åµ„Å≠"},{c:"„Å∏",e:"üêç",w:"„Å∏„Å≥"},{c:"„Åª",e:"‚≠ê",w:"„Åª„Åó"},
            {c:"„Åæ",e:"ü´ò",w:"„Åæ„ÇÅ"},{c:"„Åø",e:"üçä",w:"„Åø„Åã„Çì"},{c:"„ÇÄ",e:"üêû",w:"„ÇÄ„Åó"},{c:"„ÇÅ",e:"üëì",w:"„ÇÅ„Åå„Å≠"},{c:"„ÇÇ",e:"üçë",w:"„ÇÇ„ÇÇ"},
            {c:"„ÇÑ",e:"‚õ∞Ô∏è",w:"„ÇÑ„Åæ"},{c:"„ÇÜ",e:"‚ùÑÔ∏è",w:"„ÇÜ„Åç"},{c:"„Çà",e:"‚õµ",w:"„Çà„Å£„Å®"},
            {c:"„Çâ",e:"ü¶Å",w:"„Çâ„ÅÑ„Åä„Çì"},{c:"„Çä",e:"üçé",w:"„Çä„Çì„Åî"},{c:"„Çã",e:"üêí",w:"„Åï„Çã"},{c:"„Çå",e:"üçã",w:"„Çå„ÇÇ„Çì"},{c:"„Çç",e:"üöÄ",w:"„Çç„Åë„Å£„Å®"},
            {c:"„Çè",e:"üêä",w:"„Çè„Å´"},{c:"„Çí",e:"üìª",w:"„Çâ„Åò„Åä„Çí„Åç„Åè"},{c:"„Çì",e:"üîî",w:"„Çä„Çì"}
        ],
        dakuon: [
            {c:"„Åå",e:"ü¶Ü",w:"„Åå„Å°„Çá„ÅÜ"},{c:"„Åé",e:"üé∏",w:"„Åé„Åü„Éº"},{c:"„Åê",e:"üçá",w:"„Åê„Çå„Éº„Å∑"},{c:"„Åí",e:"üëû",w:"„Åí„Åü"},{c:"„Åî",e:"ü¶ç",w:"„Åî„Çä„Çâ"},
            {c:"„Åñ",e:"üêò",w:"„Åû„ÅÜ"},{c:"„Åò",e:"‚õëÔ∏è",w:"„Åò„Åó„Çì"},{c:"„Åö",e:"üó∫Ô∏è",w:"„Å°„Åö"},{c:"„Åú",e:" jelly",w:"„Åú„Çä„Éº"},{c:"„Åû",e:"üßπ",w:"„Åû„ÅÜ„Åç„Çì"},
            {c:"„Å†",e:"ü•Å",w:"„Åü„ÅÑ„Åì"},{c:"„Å¢",e:"ÈºªË°Ä",w:"„ÅØ„Å™„Å¢"},{c:"„Å•",e:"üëÉ",w:"„ÅØ„Å™„Åø„Å•"},{c:"„Åß",e:"üìû",w:"„Åß„Çì„Çè"},{c:"„Å©",e:"üç©",w:"„Å©„Éº„Å™„Å§"},
            {c:"„Å∞",e:"üçå",w:"„Å∞„Å™„Å™"},{c:"„Å≥",e:"üêç",w:"„Å∏„Å≥"},{c:"„Å∂",e:"üê∑",w:"„Å∂„Åü"},{c:"„Åπ",e:"üç±",w:"„Åπ„Çì„Å®„ÅÜ"},{c:"„Åº",e:"‚öΩ",w:"„Åº„Éº„Çã"},
            {c:"„Å±",e:"üêº",w:"„Å±„Çì„Å†"},{c:"„Å¥",e:"üê•",w:"„Å¥„Çà„Å¥„Çà"},{c:"„Å∑",e:"üçÆ",w:"„Å∑„Çä„Çì"},{c:"„Å∫",e:"üêß",w:"„Å∫„Çì„Åé„Çì"},{c:"„ÅΩ",e:"üìÆ",w:"„ÅΩ„Åô„Å®"}
        ],
        yoon: [
            {c:"„Åç„ÇÉ",e:"üê±",w:"„Åç„ÇÉ„Åè"},{c:"„Åç„ÇÖ",e:"ü•í",w:"„Åç„ÇÖ„ÅÜ„Çä"},{c:"„Åç„Çá",e:"ü¶à",w:"„Åç„Çá„Çä„ÇÖ„ÅÜ"},
            {c:"„Åó„ÇÉ",e:"üöó",w:"„Åó„ÇÉ„Åó„Çì"},{c:"„Åó„ÇÖ",e:"üß§",w:"„Åó„ÇÖ„Åé„Çá„ÅÜ"},{c:"„Åó„Çá",e:"üöí",w:"„Åó„Çá„ÅÜ„Åº„ÅÜ„Åó„ÇÉ"},
            {c:"„Å°„ÇÉ",e:"üçµ",w:"„Åä„Å°„ÇÉ"},{c:"„Å°„ÇÖ",e:"üê≠",w:"„Å°„ÇÖ„ÅÜ"},{c:"„Å°„Çá",e:"üç´",w:"„Å°„Çá„Åì„Çå„Éº„Å®"},
            {c:"„Å´„ÇÉ",e:"üò∏",w:"„Å´„ÇÉ„Çì„Åì"},{c:"„Å´„ÇÖ",e:"ü•õ",w:"„Å´„ÇÖ„ÅÜ„Å´„ÇÖ„ÅÜ"},{c:"„Å´„Çá",e:"üêç",w:"„Å´„Çá„Çç„Å´„Çá„Çç"},
            {c:"„Å≤„ÇÉ",e:"‚ùÑÔ∏è",w:"„Å≤„ÇÉ„Åè"},{c:"„Å≤„ÇÖ",e:"üå¨Ô∏è",w:"„Å≤„ÇÖ„ÅÜ"},{c:"„Å≤„Çá",e:"üêÜ",w:"„Å≤„Çá„ÅÜ"},
            {c:"„Åø„ÇÉ",e:"üêæ",w:"„Åø„ÇÉ„ÅÇ"},{c:"„Åø„ÇÖ",e:"üé∂",w:"„Åø„ÇÖ„Éº„Åò„Å£„Åè"},{c:"„Åø„Çá",e:"Ginger",w:"„Åø„Çá„ÅÜ„Åå"},
            {c:"„Çä„ÇÉ",e:"ü¶ñ",w:"„Çä„ÇÉ„Åè"},{c:"„Çä„ÇÖ",e:"üêâ",w:"„Çä„ÇÖ„ÅÜ"},{c:"„Çä„Çá",e:"üçµ",w:"„Çä„Çá„Åè„Å°„ÇÉ"},
            {c:"„Åé„ÇÉ",e:"üñºÔ∏è",w:"„Åé„ÇÉ„Çâ„Çä„Éº"},{c:"„Åé„ÇÖ",e:"ü•©",w:"„Åé„ÇÖ„ÅÜ„Å´„Åè"},{c:"„Åé„Çá",e:"üêü",w:"„Åé„Çá„Åã„ÅÑ"},
            {c:"„Åò„ÇÉ",e:"ü•î",w:"„Åò„ÇÉ„Åå„ÅÑ„ÇÇ"},{c:"„Åò„ÇÖ",e:"ü•§",w:"„Åò„ÇÖ„Éº„Åô"},{c:"„Åò„Çá",e:"üë∏",w:"„Åò„Çá„Åä„ÅÜ"},
            {c:"„Å≥„ÇÉ",e:"white",w:"„Å≥„ÇÉ„Å£„Åì"},{c:"„Å≥„ÇÖ",e:"view",w:"„Å≥„ÇÖ„Éº"},{c:"„Å≥„Çá",e:"üè•",w:"„Å≥„Çá„ÅÜ„ÅÑ„Çì"},
            {c:"„Å¥„ÇÉ",e:"happy",w:"„ÅØ„Å£„Å¥„ÇÉ„Åè"},{c:"„Å¥„ÇÖ",e:"pure",w:"„Å¥„ÇÖ„ÅÇ"},{c:"„Å¥„Çá",e:"üê∞",w:"„Å¥„Çá„Çì„Å¥„Çá„Çì"}
        ]
    };

    const praises = ["„Åô„Åî„ÅÑÔºÅ", "„Å¶„Çì„Åï„ÅÑ„Å†„Å≠ÔºÅ", "„ÇÑ„Å£„Åü„ÉºÔºÅ", "„Å∞„Å£„Å°„ÇäÔºÅ", "„Åä„Åø„Åî„Å®ÔºÅ"];
    let queue = [];
    let currentQ = null;
    let allInTab = [];
    let isProcessing = false;

    function initGame(tab, el) {
        if(el) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            el.classList.add('active');
        }
        allInTab = [...database[tab]];
        queue = [...allInTab].sort(() => Math.random() - 0.5);
        document.getElementById('total').innerText = allInTab.length;
        document.getElementById('result-screen').style.display = 'none';
        nextQuestion();
    }

    function playCurrent() { if(currentQ) speak(currentQ.c); }

    function speak(text) {
        window.speechSynthesis.cancel();
        const u = new SpeechSynthesisUtterance(text);
        u.lang = 'ja-JP';
        u.rate = 0.8;
        window.speechSynthesis.speak(u);
    }

    function nextQuestion() {
        if (queue.length === 0) {
            showResult();
            return;
        }

        isProcessing = false;
        currentQ = queue[0];
        document.getElementById('count').innerText = queue.length;
        document.getElementById('message').innerText = "";
        
        let choices = [currentQ];
        let others = allInTab.filter(item => item.c !== currentQ.c);
        others.sort(() => Math.random() - 0.5);
        choices.push(...others.slice(0, 3));
        choices.sort(() => Math.random() - 0.5);

        const grid = document.getElementById('options');
        grid.innerHTML = "";
        choices.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerHTML = `<span class="char">${opt.c}</span><span class="emoji">${opt.e}</span><span class="word">${opt.w}</span>`;
            btn.onclick = () => check(opt, btn);
            grid.appendChild(btn);
        });

        setTimeout(playCurrent, 500);
    }

    function check(selected, btn) {
        if(isProcessing) return;
        isProcessing = true;

        if(selected.c === currentQ.c) {
            btn.classList.add('correct');
            queue.shift(); 
            const p = praises[Math.floor(Math.random() * praises.length)];
            document.getElementById('message').innerText = p;
            speak(p);
            setTimeout(nextQuestion, 1500);
        } else {
            btn.classList.add('wrong');
            document.getElementById('message').innerText = "„Åñ„Çì„Å≠„ÇìÔºÅ„ÅÇ„Å®„Åß „Åæ„Åü „ÇÑ„Çç„ÅÜ";
            speak("„Åñ„Çì„Å≠„Çì");
            
            // ƒê∆∞a c√¢u sai xu·ªëng cu·ªëi h√†ng ƒë·ª£i
            const failed = queue.shift();
            queue.push(failed);
            
            setTimeout(nextQuestion, 1500);
        }
    }

    function showResult() {
        document.getElementById('result-screen').style.display = 'flex';
        speak("„Åä„ÇÅ„Åß„Å®„ÅÜÔºÅ„Åú„Çì„Å∂„Çì„Åõ„ÅÑ„Åã„ÅÑ„Åß„Åô");
    }

    window.onload = () => initGame('seion');
</script>

</body>
</html>